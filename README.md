# OpenData-Bridge-DataNorm

都知事杯 OpenDataHackathon 2023   
データ変換のjson作成  

## 実行方法
```Python
python datanorm.py ./data
```
./dataはcsvファイルがあるディレクトリ


ChatGPT4推奨  

プロンプト
```
異なる複数のフォーマットからなるcsvファイルを一つのフォーマットに統合したい。複数ファイルのうち、一つをmaster.csvとして、残りをslave[n].csvとする。このとき[n]は1以上の数字を想定する。
入力[input]としてmaster.csvとslave[n].csvを与えるので[rule]以下のルールに基づき、mapping_rules.jsonを作成してほしい。

[input]
master.csv
---
"施設種別","地区","保育園名","所在地","緯度","経度","種別","電話番号","入園可能月齢","保育年齢別定員　0歳","保育年齢別定員　1歳","保育年齢別定員　2歳","保育年齢別定員　3歳","保育年齢別定員　4歳","保育年齢別定員　5歳","保育年齢別定員　合計","短時間保育開始時間","短時間保育終了時間","標準時間開始時間","標準時間終了時間","延長保育対象月齢","延長保育","休園日","運営事業者(指定管理者)","保育園ホームページ"
"認可保育園","芝","芝保育園","東京都港区芝五丁目18番1号101","35.6484","139.747716","区立","03-3455-4669","3か月","18","26","30","30","30","30","164","9:00","17:00","7:15","18:15","1歳の誕生日","22:00まで","日・祝・年末年始",,"https://www.city.minato.tokyo.jp/kodomo/kodomo/kodomo/hoikuen/12/index.html"
---

slave1.csv
---
名称,郵便番号,住所,電話番号,関連ホームページ,緯度,経度
あずさわ児童館,1740051,板橋区小豆沢3-9-2-103,03-3966-2825,http://www.city.itabashi.tokyo.jp/c_sections/azuj/index.html,35.78055254,139.6960174
---

slave2.csv
---
名称,所在地,URL,電話番号,FAX,緯度,経度
子ども家庭支援センター「こどものへや」,江戸川区船堀4丁目2番5号　勤労福祉会館内1階,http://www.city.edogawa.tokyo.jp/shisetsuguide/bunya/kosodate/kateishien.html,03-3877-2460,03-3877-2461,35.685187,139.8653337
---

slave3.csv
---
施設名,カテゴリ,所在地,方書,郵便番号,電話番号,開所時刻,閉所時刻,備考,緯度（施設出入口）,経度（施設出入口）,緯度（施設中心）,経度（施設中心）
稲城市立第三保育園,子育て,稲城市坂浜1012番地の2,,2060822,042-331-0802,7:00,19:00,,35.622436,139.484959,35.622479,139.485152
---

slave4.csv
---
都道府県名,市区町村名,名称,名称_カナ,種別,住所,方書,緯度,経度,アクセス方法,駐車場情報,電話番号,内線番号,FAX番号,法人番号,団体名,認可等年月日,収容定員,受入年齢,利用可能曜日,開始時間,終了時間,利用可能日時特記事項,一時預かりの有無,URL,備考,,
東京都,清瀬市,清瀬市立第１保育園,キヨセシリツダイイチホイクエン,認定公立保育所,東京都清瀬市松山3-1-73,,35.76854,139.513793,,,042-491-0152,,,,清瀬市,1955/6/1,98,0歳から,月火水木金土,7:00,19:00,,有,,,,
---

slave5.csv
---
市区町村コード,NO,都道府県名,市区町村名,名称,名称_カナ,種別,住所,方書,緯度,経度,アクセス方法,駐車場情報,電話番号,内線番号,FAX番号,法人番号,団体名,認可等年月日,収容定員,受入年齢,利用可能曜日,開始時間,終了時間,利用可能日時特記事項,一時預かりの有無,URL,備考
132217,,東京都,清瀬市,清瀬市立う梅園第1第2第3学童クラブ,キヨセシリツウメゾノダイイチダイニダイサンガクドウクラブ,,東京都清瀬市梅園2-9-38,,35.771999,139.505174,,,042-492-5606,,,,清瀬市,,100,小学校1年生～6年生,月火水木金土,,,通常下校時間～18：15。また、三季休業日は8：30～18：00。,無,,
---

[rule]
1) 以下[input ex]のようにmaster.csvとslave[n].csvが与えられた場合、[output ex]のようなmapping_rules.jsonを出力する。
ここで注意してほしいのはそのような変換プログラムの作成ではなく、jsonファイル作成の依頼であるということ。
2) csvの項目名とデータの内容から、masterとslaveの項目の対応関係を推測し、同じと思われるmasterの項目１つと配列で与えられるslave[n]の項目の対応関係をjsonファイルにする。
3) masterの項目は必ず対応関係の配列の1番目に追加しておく。
4) 対応関係の配列に重複する項目は必要ない。
5) slaveに存在し、masterには存在しない項目は捨てて良い。
6) masterには存在し、slaveには存在しない項目は対応関係の配列に記載しなくてよい。
7) master.csvに存在する項目が、対応関係の配列で2番目以降に出現する場合、その項目は対応関係の配列から除外する。
8) 以下に示すのは１例であって、必要なのはrule 1〜7で示されたルールを厳守し、[input]の方で提示しているmasterの各項目へのslave[n]の対応関係を漏らさずmapping_rules.jsonとして出力することである。

[input ex]
master.csv
---
"施設種別","保育園名","所在地"
"認可保育園","芝保育園","東京都港区芝五丁目18番1号101"
"認可保育園","神明保育園","東京都港区浜松町一丁目6番7号　プラザ神明1～3階"
---

slave1.csv
---
名称,住所,
あずさわ児童館,板橋区小豆沢3-9-2-103
---

slave2.csv
---
施設名称,所在地,
子ども家庭支援センター「こどものへや」,江戸川区船堀4丁目2番5号　勤労福祉会館内1階
---

[output ex]
mapping_rules.json
---
{
    "保育園名":[
        "保育園名",
        "施設名",
        "施設名称"
    ],
    "所在地":[
        "所在地",
        "住所",
    ]
}
---
```
